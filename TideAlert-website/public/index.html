<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ESP Firebase App</title>

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
            integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="style_main.css">

        <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>


        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
            https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="https://www.gstatic.com/firebasejs/8.8.1/firebase-database.js"></script>

        <script>
            var firebaseConfig = {
                apiKey: "AIzaSyA69eyrrZa7JYToEDzq6CwBoy5gOmFX5dU",
                authDomain: "tidealert-4d45a.firebaseapp.com",
                databaseURL: "https://tidealert-4d45a-default-rtdb.asia-southeast1.firebasedatabase.app",
                projectId: "tidealert-4d45a",
                storageBucket: "tidealert-4d45a.appspot.com",
                messagingSenderId: "744565656433",
                appId: "1:744565656433:web:f8520bb49985bffd6404d0"
            }
            firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
        </script>

        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
        <title>TideAlert Monitored Locations</title>

        <style>
            h1 {
                text-align: center;
                margin: 15px 0px 25px;
            }

            #map {
                height: 80vh;
                width: 90vw;
                margin: auto;
            }

            .popup {
                font-size: 1.3rem;
            }
        </style>

    </head>


<body>
    <h1>Tide monitored locations</h1>
    <div id="map"></div>

</body>

<script>
    var map = L.map('map');
    map.setView([22.39, 114.188409], 11);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    navigator.geolocation.watchPosition(success, error);

    let working;
    function success(pos) {
        const lat = pos.coords.latitude;
        const lng = pos.coords.longitude;
        const accuracy = pos.coords.accuracy;

        if (working) {
            map.removeLayer(working);
        }
        working = L.marker([lat, lng]).addTo(map);
        working.bindTooltip("Working station");
        working.bindPopup("<a href=station.html target=_blank>Station Data</a>");
        map.fitBounds();
    }
    let useless;
    useless= L.marker([22.4, 114.21]).addTo(map);
    useless.bindTooltip("Under maintenance")

    let useless2;
    useless2= L.marker([22.32, 113.93]).addTo(map);
    useless2.bindTooltip("Under maintenance2")

    let useless3;
    useless3= L.marker([22.23, 114.20]).addTo(map);
    useless3.bindTooltip("Under maintenance3")

    let useless4;
    useless4= L.marker([22.41, 113.92]).addTo(map);
    useless4.bindTooltip("Under maintenance4")    
    
    let useless5;
    useless5= L.marker([22.3, 114.23]).addTo(map);
    useless5.bindTooltip("Under maintenance5")

    function error(err) {
        if (err.code === 1) {
            alert("Please allow location access for best use of website");
        } else {
            alert("Cannot get your current location");
        }
    }

</script>

</html>